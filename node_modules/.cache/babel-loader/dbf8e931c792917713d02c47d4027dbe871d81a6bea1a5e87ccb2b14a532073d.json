{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\nvar _Object$defineProperties = require(\"@babel/runtime-corejs3/core-js-stable/object/define-properties\");\nvar _Object$getOwnPropertyDescriptors = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors\");\nvar _forEachInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/for-each\");\nvar _Object$getOwnPropertyDescriptor = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor\");\nvar _filterInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/filter\");\nvar _Object$getOwnPropertySymbols = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols\");\nvar _Object$keys = require(\"@babel/runtime-corejs3/core-js-stable/object/keys\");\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/defineProperty\"));\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/typeof\"));\nvar _setTimeout2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/set-timeout\"));\nvar _includes = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/includes\"));\nvar _stringify = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/json/stringify\"));\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/promise\"));\nvar _CoreManager = _interopRequireDefault(require(\"./CoreManager\"));\nvar _ParseError = _interopRequireDefault(require(\"./ParseError\"));\nvar _promiseUtils = require(\"./promiseUtils\");\nfunction ownKeys(object, enumerableOnly) {\n  var keys = _Object$keys(object);\n  if (_Object$getOwnPropertySymbols) {\n    var symbols = _Object$getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = _filterInstanceProperty(symbols).call(symbols, function (sym) {\n      return _Object$getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var _context4, _context5;\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? _forEachInstanceProperty(_context4 = ownKeys(Object(source), !0)).call(_context4, function (key) {\n      (0, _defineProperty2.default)(target, key, source[key]);\n    }) : _Object$getOwnPropertyDescriptors ? _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)) : _forEachInstanceProperty(_context5 = ownKeys(Object(source))).call(_context5, function (key) {\n      _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key));\n    });\n  }\n  return target;\n}\n/**\n * @flow\n */\n\n/* global XMLHttpRequest, XDomainRequest */\n\nvar uuidv4 = require('./uuid');\nvar XHR = null;\nif (typeof XMLHttpRequest !== 'undefined') {\n  XHR = XMLHttpRequest;\n}\nvar useXDomainRequest = false;\nif (typeof XDomainRequest !== 'undefined' && !('withCredentials' in new XMLHttpRequest())) {\n  useXDomainRequest = true;\n}\nfunction ajaxIE9(method\n/*: string*/, url\n/*: string*/, data\n/*: any*/, headers\n/*:: ?: any*/, options\n/*:: ?: FullOptions*/) {\n  return new _promise.default(function (resolve, reject) {\n    var xdr = new XDomainRequest();\n    xdr.onload = function () {\n      var response;\n      try {\n        response = JSON.parse(xdr.responseText);\n      } catch (e) {\n        reject(e);\n      }\n      if (response) {\n        resolve({\n          response: response\n        });\n      }\n    };\n    xdr.onerror = xdr.ontimeout = function () {\n      // Let's fake a real error message.\n      var fakeResponse = {\n        responseText: (0, _stringify.default)({\n          code: _ParseError.default.X_DOMAIN_REQUEST,\n          error: \"IE's XDomainRequest does not supply error info.\"\n        })\n      };\n      reject(fakeResponse);\n    };\n    xdr.onprogress = function () {\n      if (options && typeof options.progress === 'function') {\n        options.progress(xdr.responseText);\n      }\n    };\n    xdr.open(method, url);\n    xdr.send(data);\n    if (options && typeof options.requestTask === 'function') {\n      options.requestTask(xdr);\n    }\n  });\n}\nvar RESTController = {\n  ajax: function (method\n  /*: string*/, url\n  /*: string*/, data\n  /*: any*/, headers\n  /*:: ?: any*/, options\n  /*:: ?: FullOptions*/) {\n    var _context;\n    if (useXDomainRequest) {\n      return ajaxIE9(method, url, data, headers, options);\n    }\n    var promise = (0, _promiseUtils.resolvingPromise)();\n    var isIdempotent = _CoreManager.default.get('IDEMPOTENCY') && (0, _includes.default)(_context = ['POST', 'PUT']).call(_context, method);\n    var requestId = isIdempotent ? uuidv4() : '';\n    var attempts = 0;\n    (function dispatch() {\n      if (XHR == null) {\n        throw new Error('Cannot make a request: No definition of XMLHttpRequest was found.');\n      }\n      var handled = false;\n      var xhr = new XHR();\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState !== 4 || handled || xhr._aborted) {\n          return;\n        }\n        handled = true;\n        if (xhr.status >= 200 && xhr.status < 300) {\n          var response;\n          try {\n            response = JSON.parse(xhr.responseText);\n            if (typeof xhr.getResponseHeader === 'function') {\n              var _context2, _context3;\n              if ((0, _includes.default)(_context2 = xhr.getAllResponseHeaders() || '').call(_context2, 'x-parse-job-status-id: ')) {\n                response = xhr.getResponseHeader('x-parse-job-status-id');\n              }\n              if ((0, _includes.default)(_context3 = xhr.getAllResponseHeaders() || '').call(_context3, 'x-parse-push-status-id: ')) {\n                response = xhr.getResponseHeader('x-parse-push-status-id');\n              }\n            }\n          } catch (e) {\n            promise.reject(e.toString());\n          }\n          if (response) {\n            promise.resolve({\n              response: response,\n              status: xhr.status,\n              xhr: xhr\n            });\n          }\n        } else if (xhr.status >= 500 || xhr.status === 0) {\n          // retry on 5XX or node-xmlhttprequest error\n          if (++attempts < _CoreManager.default.get('REQUEST_ATTEMPT_LIMIT')) {\n            // Exponentially-growing random delay\n            var delay = Math.round(Math.random() * 125 * Math.pow(2, attempts));\n            (0, _setTimeout2.default)(dispatch, delay);\n          } else if (xhr.status === 0) {\n            promise.reject('Unable to connect to the Parse API');\n          } else {\n            // After the retry limit is reached, fail\n            promise.reject(xhr);\n          }\n        } else {\n          promise.reject(xhr);\n        }\n      };\n      headers = headers || {};\n      if (typeof headers['Content-Type'] !== 'string') {\n        headers['Content-Type'] = 'text/plain'; // Avoid pre-flight\n      }\n\n      if (_CoreManager.default.get('IS_NODE')) {\n        headers['User-Agent'] = 'Parse/' + _CoreManager.default.get('VERSION') + ' (NodeJS ' + process.versions.node + ')';\n      }\n      if (isIdempotent) {\n        headers['X-Parse-Request-Id'] = requestId;\n      }\n      if (_CoreManager.default.get('SERVER_AUTH_TYPE') && _CoreManager.default.get('SERVER_AUTH_TOKEN')) {\n        headers['Authorization'] = _CoreManager.default.get('SERVER_AUTH_TYPE') + ' ' + _CoreManager.default.get('SERVER_AUTH_TOKEN');\n      }\n      var customHeaders = _CoreManager.default.get('REQUEST_HEADERS');\n      for (var key in customHeaders) {\n        headers[key] = customHeaders[key];\n      }\n      if (options && typeof options.progress === 'function') {\n        var handleProgress = function handleProgress(type, event) {\n          if (event.lengthComputable) {\n            options.progress(event.loaded / event.total, event.loaded, event.total, {\n              type: type\n            });\n          } else {\n            options.progress(null, null, null, {\n              type: type\n            });\n          }\n        };\n        xhr.onprogress = function (event) {\n          handleProgress('download', event);\n        };\n        if (xhr.upload) {\n          xhr.upload.onprogress = function (event) {\n            handleProgress('upload', event);\n          };\n        }\n      }\n      xhr.open(method, url, true);\n      for (var h in headers) {\n        xhr.setRequestHeader(h, headers[h]);\n      }\n      xhr.onabort = function () {\n        promise.resolve({\n          response: {\n            results: []\n          },\n          status: 0,\n          xhr: xhr\n        });\n      };\n      xhr.send(data);\n      if (options && typeof options.requestTask === 'function') {\n        options.requestTask(xhr);\n      }\n    })();\n    return promise;\n  },\n  request: function request(method\n  /*: string*/, path\n  /*: string*/, data\n  /*: mixed*/, options\n  /*:: ?: RequestOptions*/) {\n    options = options || {};\n    var url = _CoreManager.default.get('SERVER_URL');\n    if (url[url.length - 1] !== '/') {\n      url += '/';\n    }\n    url += path;\n    var payload = {};\n    if (data && (0, _typeof2.default)(data) === 'object') {\n      for (var k in data) {\n        payload[k] = data[k];\n      }\n    } // Add context\n\n    var context = options.context;\n    if (context !== undefined) {\n      payload._context = context;\n    }\n    if (method !== 'POST') {\n      payload._method = method;\n      method = 'POST';\n    }\n    payload._ApplicationId = _CoreManager.default.get('APPLICATION_ID');\n    var jsKey = _CoreManager.default.get('JAVASCRIPT_KEY');\n    if (jsKey) {\n      payload._JavaScriptKey = jsKey;\n    }\n    payload._ClientVersion = _CoreManager.default.get('VERSION');\n    var useMasterKey = options.useMasterKey;\n    if (typeof useMasterKey === 'undefined') {\n      useMasterKey = _CoreManager.default.get('USE_MASTER_KEY');\n    }\n    if (useMasterKey) {\n      if (_CoreManager.default.get('MASTER_KEY')) {\n        delete payload._JavaScriptKey;\n        payload._MasterKey = _CoreManager.default.get('MASTER_KEY');\n      } else {\n        throw new Error('Cannot use the Master Key, it has not been provided.');\n      }\n    }\n    if (_CoreManager.default.get('FORCE_REVOCABLE_SESSION')) {\n      payload._RevocableSession = '1';\n    }\n    var installationId = options.installationId;\n    var installationIdPromise;\n    if (installationId && typeof installationId === 'string') {\n      installationIdPromise = _promise.default.resolve(installationId);\n    } else {\n      var installationController = _CoreManager.default.getInstallationController();\n      installationIdPromise = installationController.currentInstallationId();\n    }\n    return installationIdPromise.then(function (iid) {\n      payload._InstallationId = iid;\n      var userController = _CoreManager.default.getUserController();\n      if (options && typeof options.sessionToken === 'string') {\n        return _promise.default.resolve(options.sessionToken);\n      } else if (userController) {\n        return userController.currentUserAsync().then(function (user) {\n          if (user) {\n            return _promise.default.resolve(user.getSessionToken());\n          }\n          return _promise.default.resolve(null);\n        });\n      }\n      return _promise.default.resolve(null);\n    }).then(function (token) {\n      if (token) {\n        payload._SessionToken = token;\n      }\n      var payloadString = (0, _stringify.default)(payload);\n      return RESTController.ajax(method, url, payloadString, {}, options).then(function (_ref) {\n        var response = _ref.response,\n          status = _ref.status;\n        if (options.returnStatus) {\n          return _objectSpread(_objectSpread({}, response), {}, {\n            _status: status\n          });\n        } else {\n          return response;\n        }\n      });\n    }).catch(RESTController.handleError);\n  },\n  handleError: function handleError(response) {\n    // Transform the error into an instance of ParseError by trying to parse\n    // the error string as JSON\n    var error;\n    if (response && response.responseText) {\n      try {\n        var errorJSON = JSON.parse(response.responseText);\n        error = new _ParseError.default(errorJSON.code, errorJSON.error);\n      } catch (e) {\n        // If we fail to parse the error text, that's okay.\n        error = new _ParseError.default(_ParseError.default.INVALID_JSON, 'Received an error with invalid JSON from Parse: ' + response.responseText);\n      }\n    } else {\n      var message = response.message ? response.message : response;\n      error = new _ParseError.default(_ParseError.default.CONNECTION_FAILED, 'XMLHttpRequest failed: ' + (0, _stringify.default)(message));\n    }\n    return _promise.default.reject(error);\n  },\n  _setXHR: function _setXHR(xhr\n  /*: any*/) {\n    XHR = xhr;\n  },\n  _getXHR: function _getXHR() {\n    return XHR;\n  }\n};\nmodule.exports = RESTController;","map":{"version":3,"names":["_interopRequireDefault","require","_Object$defineProperty","_Object$defineProperties","_Object$getOwnPropertyDescriptors","_forEachInstanceProperty","_Object$getOwnPropertyDescriptor","_filterInstanceProperty","_Object$getOwnPropertySymbols","_Object$keys","_defineProperty2","_typeof2","_setTimeout2","_includes","_stringify","_promise","_CoreManager","_ParseError","_promiseUtils","ownKeys","object","enumerableOnly","keys","symbols","call","sym","enumerable","push","apply","_objectSpread","target","i","arguments","length","_context4","_context5","source","Object","key","default","uuidv4","XHR","XMLHttpRequest","useXDomainRequest","XDomainRequest","ajaxIE9","method","url","data","headers","options","resolve","reject","xdr","onload","response","JSON","parse","responseText","e","onerror","ontimeout","fakeResponse","code","X_DOMAIN_REQUEST","error","onprogress","progress","open","send","requestTask","RESTController","ajax","_context","promise","resolvingPromise","isIdempotent","get","requestId","attempts","dispatch","Error","handled","xhr","onreadystatechange","readyState","_aborted","status","getResponseHeader","_context2","_context3","getAllResponseHeaders","toString","delay","Math","round","random","pow","process","versions","node","customHeaders","handleProgress","type","event","lengthComputable","loaded","total","upload","h","setRequestHeader","onabort","results","request","path","payload","k","context","undefined","_method","_ApplicationId","jsKey","_JavaScriptKey","_ClientVersion","useMasterKey","_MasterKey","_RevocableSession","installationId","installationIdPromise","installationController","getInstallationController","currentInstallationId","then","iid","_InstallationId","userController","getUserController","sessionToken","currentUserAsync","user","getSessionToken","token","_SessionToken","payloadString","_ref","returnStatus","_status","catch","handleError","errorJSON","INVALID_JSON","message","CONNECTION_FAILED","_setXHR","_getXHR","module","exports"],"sources":["/Users/nnwhalen/Desktop/NOTREDAME/web dev/node_modules/parse/lib/browser/RESTController.js"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\n\nvar _Object$defineProperties = require(\"@babel/runtime-corejs3/core-js-stable/object/define-properties\");\n\nvar _Object$getOwnPropertyDescriptors = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors\");\n\nvar _forEachInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/for-each\");\n\nvar _Object$getOwnPropertyDescriptor = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor\");\n\nvar _filterInstanceProperty = require(\"@babel/runtime-corejs3/core-js-stable/instance/filter\");\n\nvar _Object$getOwnPropertySymbols = require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols\");\n\nvar _Object$keys = require(\"@babel/runtime-corejs3/core-js-stable/object/keys\");\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/defineProperty\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/typeof\"));\n\nvar _setTimeout2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/set-timeout\"));\n\nvar _includes = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/includes\"));\n\nvar _stringify = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/json/stringify\"));\n\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/promise\"));\n\nvar _CoreManager = _interopRequireDefault(require(\"./CoreManager\"));\n\nvar _ParseError = _interopRequireDefault(require(\"./ParseError\"));\n\nvar _promiseUtils = require(\"./promiseUtils\");\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = _Object$keys(object);\n\n  if (_Object$getOwnPropertySymbols) {\n    var symbols = _Object$getOwnPropertySymbols(object);\n\n    enumerableOnly && (symbols = _filterInstanceProperty(symbols).call(symbols, function (sym) {\n      return _Object$getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var _context4, _context5;\n\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? _forEachInstanceProperty(_context4 = ownKeys(Object(source), !0)).call(_context4, function (key) {\n      (0, _defineProperty2.default)(target, key, source[key]);\n    }) : _Object$getOwnPropertyDescriptors ? _Object$defineProperties(target, _Object$getOwnPropertyDescriptors(source)) : _forEachInstanceProperty(_context5 = ownKeys(Object(source))).call(_context5, function (key) {\n      _Object$defineProperty(target, key, _Object$getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n/**\n * @flow\n */\n\n/* global XMLHttpRequest, XDomainRequest */\n\n\nvar uuidv4 = require('./uuid');\n\nvar XHR = null;\n\nif (typeof XMLHttpRequest !== 'undefined') {\n  XHR = XMLHttpRequest;\n}\n\nvar useXDomainRequest = false;\n\nif (typeof XDomainRequest !== 'undefined' && !('withCredentials' in new XMLHttpRequest())) {\n  useXDomainRequest = true;\n}\n\nfunction ajaxIE9(method\n/*: string*/\n, url\n/*: string*/\n, data\n/*: any*/\n, headers\n/*:: ?: any*/\n, options\n/*:: ?: FullOptions*/\n) {\n  return new _promise.default(function (resolve, reject) {\n    var xdr = new XDomainRequest();\n\n    xdr.onload = function () {\n      var response;\n\n      try {\n        response = JSON.parse(xdr.responseText);\n      } catch (e) {\n        reject(e);\n      }\n\n      if (response) {\n        resolve({\n          response: response\n        });\n      }\n    };\n\n    xdr.onerror = xdr.ontimeout = function () {\n      // Let's fake a real error message.\n      var fakeResponse = {\n        responseText: (0, _stringify.default)({\n          code: _ParseError.default.X_DOMAIN_REQUEST,\n          error: \"IE's XDomainRequest does not supply error info.\"\n        })\n      };\n      reject(fakeResponse);\n    };\n\n    xdr.onprogress = function () {\n      if (options && typeof options.progress === 'function') {\n        options.progress(xdr.responseText);\n      }\n    };\n\n    xdr.open(method, url);\n    xdr.send(data);\n\n    if (options && typeof options.requestTask === 'function') {\n      options.requestTask(xdr);\n    }\n  });\n}\n\nvar RESTController = {\n  ajax: function (method\n  /*: string*/\n  , url\n  /*: string*/\n  , data\n  /*: any*/\n  , headers\n  /*:: ?: any*/\n  , options\n  /*:: ?: FullOptions*/\n  ) {\n    var _context;\n\n    if (useXDomainRequest) {\n      return ajaxIE9(method, url, data, headers, options);\n    }\n\n    var promise = (0, _promiseUtils.resolvingPromise)();\n    var isIdempotent = _CoreManager.default.get('IDEMPOTENCY') && (0, _includes.default)(_context = ['POST', 'PUT']).call(_context, method);\n    var requestId = isIdempotent ? uuidv4() : '';\n    var attempts = 0;\n\n    (function dispatch() {\n      if (XHR == null) {\n        throw new Error('Cannot make a request: No definition of XMLHttpRequest was found.');\n      }\n\n      var handled = false;\n      var xhr = new XHR();\n\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState !== 4 || handled || xhr._aborted) {\n          return;\n        }\n\n        handled = true;\n\n        if (xhr.status >= 200 && xhr.status < 300) {\n          var response;\n\n          try {\n            response = JSON.parse(xhr.responseText);\n\n            if (typeof xhr.getResponseHeader === 'function') {\n              var _context2, _context3;\n\n              if ((0, _includes.default)(_context2 = xhr.getAllResponseHeaders() || '').call(_context2, 'x-parse-job-status-id: ')) {\n                response = xhr.getResponseHeader('x-parse-job-status-id');\n              }\n\n              if ((0, _includes.default)(_context3 = xhr.getAllResponseHeaders() || '').call(_context3, 'x-parse-push-status-id: ')) {\n                response = xhr.getResponseHeader('x-parse-push-status-id');\n              }\n            }\n          } catch (e) {\n            promise.reject(e.toString());\n          }\n\n          if (response) {\n            promise.resolve({\n              response: response,\n              status: xhr.status,\n              xhr: xhr\n            });\n          }\n        } else if (xhr.status >= 500 || xhr.status === 0) {\n          // retry on 5XX or node-xmlhttprequest error\n          if (++attempts < _CoreManager.default.get('REQUEST_ATTEMPT_LIMIT')) {\n            // Exponentially-growing random delay\n            var delay = Math.round(Math.random() * 125 * Math.pow(2, attempts));\n            (0, _setTimeout2.default)(dispatch, delay);\n          } else if (xhr.status === 0) {\n            promise.reject('Unable to connect to the Parse API');\n          } else {\n            // After the retry limit is reached, fail\n            promise.reject(xhr);\n          }\n        } else {\n          promise.reject(xhr);\n        }\n      };\n\n      headers = headers || {};\n\n      if (typeof headers['Content-Type'] !== 'string') {\n        headers['Content-Type'] = 'text/plain'; // Avoid pre-flight\n      }\n\n      if (_CoreManager.default.get('IS_NODE')) {\n        headers['User-Agent'] = 'Parse/' + _CoreManager.default.get('VERSION') + ' (NodeJS ' + process.versions.node + ')';\n      }\n\n      if (isIdempotent) {\n        headers['X-Parse-Request-Id'] = requestId;\n      }\n\n      if (_CoreManager.default.get('SERVER_AUTH_TYPE') && _CoreManager.default.get('SERVER_AUTH_TOKEN')) {\n        headers['Authorization'] = _CoreManager.default.get('SERVER_AUTH_TYPE') + ' ' + _CoreManager.default.get('SERVER_AUTH_TOKEN');\n      }\n\n      var customHeaders = _CoreManager.default.get('REQUEST_HEADERS');\n\n      for (var key in customHeaders) {\n        headers[key] = customHeaders[key];\n      }\n\n      if (options && typeof options.progress === 'function') {\n        var handleProgress = function handleProgress(type, event) {\n          if (event.lengthComputable) {\n            options.progress(event.loaded / event.total, event.loaded, event.total, {\n              type: type\n            });\n          } else {\n            options.progress(null, null, null, {\n              type: type\n            });\n          }\n        };\n\n        xhr.onprogress = function (event) {\n          handleProgress('download', event);\n        };\n\n        if (xhr.upload) {\n          xhr.upload.onprogress = function (event) {\n            handleProgress('upload', event);\n          };\n        }\n      }\n\n      xhr.open(method, url, true);\n\n      for (var h in headers) {\n        xhr.setRequestHeader(h, headers[h]);\n      }\n\n      xhr.onabort = function () {\n        promise.resolve({\n          response: {\n            results: []\n          },\n          status: 0,\n          xhr: xhr\n        });\n      };\n\n      xhr.send(data);\n\n      if (options && typeof options.requestTask === 'function') {\n        options.requestTask(xhr);\n      }\n    })();\n\n    return promise;\n  },\n  request: function request(method\n  /*: string*/\n  , path\n  /*: string*/\n  , data\n  /*: mixed*/\n  , options\n  /*:: ?: RequestOptions*/\n  ) {\n    options = options || {};\n\n    var url = _CoreManager.default.get('SERVER_URL');\n\n    if (url[url.length - 1] !== '/') {\n      url += '/';\n    }\n\n    url += path;\n    var payload = {};\n\n    if (data && (0, _typeof2.default)(data) === 'object') {\n      for (var k in data) {\n        payload[k] = data[k];\n      }\n    } // Add context\n\n\n    var context = options.context;\n\n    if (context !== undefined) {\n      payload._context = context;\n    }\n\n    if (method !== 'POST') {\n      payload._method = method;\n      method = 'POST';\n    }\n\n    payload._ApplicationId = _CoreManager.default.get('APPLICATION_ID');\n\n    var jsKey = _CoreManager.default.get('JAVASCRIPT_KEY');\n\n    if (jsKey) {\n      payload._JavaScriptKey = jsKey;\n    }\n\n    payload._ClientVersion = _CoreManager.default.get('VERSION');\n    var useMasterKey = options.useMasterKey;\n\n    if (typeof useMasterKey === 'undefined') {\n      useMasterKey = _CoreManager.default.get('USE_MASTER_KEY');\n    }\n\n    if (useMasterKey) {\n      if (_CoreManager.default.get('MASTER_KEY')) {\n        delete payload._JavaScriptKey;\n        payload._MasterKey = _CoreManager.default.get('MASTER_KEY');\n      } else {\n        throw new Error('Cannot use the Master Key, it has not been provided.');\n      }\n    }\n\n    if (_CoreManager.default.get('FORCE_REVOCABLE_SESSION')) {\n      payload._RevocableSession = '1';\n    }\n\n    var installationId = options.installationId;\n    var installationIdPromise;\n\n    if (installationId && typeof installationId === 'string') {\n      installationIdPromise = _promise.default.resolve(installationId);\n    } else {\n      var installationController = _CoreManager.default.getInstallationController();\n\n      installationIdPromise = installationController.currentInstallationId();\n    }\n\n    return installationIdPromise.then(function (iid) {\n      payload._InstallationId = iid;\n\n      var userController = _CoreManager.default.getUserController();\n\n      if (options && typeof options.sessionToken === 'string') {\n        return _promise.default.resolve(options.sessionToken);\n      } else if (userController) {\n        return userController.currentUserAsync().then(function (user) {\n          if (user) {\n            return _promise.default.resolve(user.getSessionToken());\n          }\n\n          return _promise.default.resolve(null);\n        });\n      }\n\n      return _promise.default.resolve(null);\n    }).then(function (token) {\n      if (token) {\n        payload._SessionToken = token;\n      }\n\n      var payloadString = (0, _stringify.default)(payload);\n      return RESTController.ajax(method, url, payloadString, {}, options).then(function (_ref) {\n        var response = _ref.response,\n            status = _ref.status;\n\n        if (options.returnStatus) {\n          return _objectSpread(_objectSpread({}, response), {}, {\n            _status: status\n          });\n        } else {\n          return response;\n        }\n      });\n    }).catch(RESTController.handleError);\n  },\n  handleError: function handleError(response) {\n    // Transform the error into an instance of ParseError by trying to parse\n    // the error string as JSON\n    var error;\n\n    if (response && response.responseText) {\n      try {\n        var errorJSON = JSON.parse(response.responseText);\n        error = new _ParseError.default(errorJSON.code, errorJSON.error);\n      } catch (e) {\n        // If we fail to parse the error text, that's okay.\n        error = new _ParseError.default(_ParseError.default.INVALID_JSON, 'Received an error with invalid JSON from Parse: ' + response.responseText);\n      }\n    } else {\n      var message = response.message ? response.message : response;\n      error = new _ParseError.default(_ParseError.default.CONNECTION_FAILED, 'XMLHttpRequest failed: ' + (0, _stringify.default)(message));\n    }\n\n    return _promise.default.reject(error);\n  },\n  _setXHR: function _setXHR(xhr\n  /*: any*/\n  ) {\n    XHR = xhr;\n  },\n  _getXHR: function _getXHR() {\n    return XHR;\n  }\n};\nmodule.exports = RESTController;"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}